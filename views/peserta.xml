<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>
        <record id="cdn_peserta_list" model="ir.ui.view">
            <field name="name">cdn.peserta.form</field>

            <field name="model">cdn.peserta</field>

            <field name="arch" type="xml">
                <list>
                    <field name="name" />

                    <field name="jenis_kelamin" />

                    <field name="street" string="Alamat" />

                    <field name="mobile" string="No. HP" />

                    <field name="email" />
                </list>
            </field>
        </record>

        <record id="cdn_peserta_search" model="ir.ui.view">
            <field name="name">cdn.peserta.search</field>

            <field name="model">cdn.peserta</field>

            <field name="arch" type="xml">
                <search>
                    <filter name="jenis_kelamin_l" string="Laki-laki" domain="[('jenis_kelamin', '=', 'l')]" />

                    <filter name="jenis_kelamin_p" string="Perempuan" domain="[('jenis_kelamin', '=', 'p')]" />

                    <filter name="is_menikah" string="Status Pernikahan" context="{'group_by': 'is_menikah'}" />
                </search>
            </field>
        </record>

        <record id="cdn_peserta_form" model="ir.ui.view">
            <field name="name">cdn.peserta.form</field>

            <field name="model">cdn.peserta</field>

            <field name="arch" type="xml">
                <form string="Peserta">
                    <sheet>
                        <div class="oe_title">
                            <h3>
                                <label for="no_peserta" string="No Peserta" />
                            </h3>
                            <h1>
                                <field name="no_peserta" class="mb-0 mt-1" />
                            </h1>
                        </div>

                        <div class="row">
                            <div class="col">
                                <group string="Identitas Siswa">
                                    <group>
                                        <field name="name" required="1" />

                                        <field name="jenis_kelamin" required="1" />

                                        <field name="email" />
                                    </group>
                                    <group>
                                        <field name="mobile" string="No. HP" required="1" />

                                        <field name="tmp_lahir" />

                                        <field name="tgl_lahir" />
                                    </group>
                                </group>
                            </div>

                            <div class="col ms-2">
                                <group string="Alamat">
                                    <group colspan="4">
                                        <field name="street" string="Alamat" />
                                    </group>

                                    <group>
                                        <field name="provinsi_id" />
                                        <field name="kota_id" domain="[('provinsi_id', '=', provinsi_id)]" />
                                    </group>

                                    <group>
                                        <field name="kecamatan_id" domain="[('kota_id', '=', kota_id)]" />
                                        <field name="desa_id" domain="[('kecamatan_id', '=', kecamatan_id)]" />
                                    </group>

                                    <group>
                                        <field name="pendidikan" />
                                        <field name="is_menikah" />
                                    </group>

                                    <group>
                                        <field name="pekerjaan" />
                                    </group>
                                </group>
                            </div>

                            <div class="col-1">
                                <group string="Foto">
                                    <div class="float-end" style="width: 100%; height: 100%;">
                                        <field name="profile_image" widget="image" class="rounded" />
                                    </div>
                                </group>
                            </div>
                        </div>

                        <group string="Pasangan" invisible="not is_menikah">
                            <div class="row">
                                <div class="col">
                                    <group>
                                        <field name="nama_pasangan" required="is_menikah" />
                                    </group>
                                </div>

                                <div class="col">
                                    <group>
                                        <field name="hp_pasangan" required="is_menikah" />
                                    </group>
                                </div>

                                <div class="col-1" />
                            </div>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="seq_peserta" model="ir.sequence">
            <field name="name">Urutan Peserta</field>

            <field name="code">sequence.peserta</field>

            <field name="prefix">A/%(y)s/%(month)s/</field>

            <field name="padding">4</field>

            <field name="number_increment">1</field>

            <field name="implementation">standard</field>
        </record>

        <record id="action_generate_no_peserta" model="ir.actions.server">
            <field name="name">Generate No Peserta</field>

            <field name="model_id" ref="model_cdn_peserta" />

            <field name="binding_model_id" ref="model_cdn_peserta" />

            <field name="state">code</field>

            <field name="code">                
                action = records.action_generate_no_peserta()
            </field>
        </record>

        <record id="cdn_peserta_action_laki" model="ir.actions.act_window">
            <field name="name">Data Peserta Laki-laki</field>

            <field name="type">ir.actions.act_window</field>

            <field name="res_model">cdn.peserta</field>

            <field name="view_mode">list,form</field>

            <field name="domain">[('jenis_kelamin','=','l')]</field>

            <field name="context">{'default_jenis_kelamin':'l'}</field>

            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    <!-- Add Text Here -->
                </p>
                <p>
                    <!-- More details about what a user can do with this object will be OK -->
                </p>
            </field>
        </record>

        <record id="cdn_peserta_action_perempuan" model="ir.actions.act_window">
            <field name="name">Data Peserta Perempuan</field>

            <field name="type">ir.actions.act_window</field>

            <field name="res_model">cdn.peserta</field>

            <field name="view_mode">list,form</field>

            <field name="domain">[('jenis_kelamin','=','p')]</field>

            <field name="context">{'default_jenis_kelamin':'p'}</field>

            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    <!-- Add Text Here -->
                </p>
                <p>
                    <!-- More details about what a user can do with this object will be OK -->
                </p>
            </field>
        </record>

        <record id="cdn_peserta_action_all" model="ir.actions.act_window">
            <field name="name">Data Semua Peserta</field>

            <field name="type">ir.actions.act_window</field>

            <field name="res_model">cdn.peserta</field>

            <field name="view_mode">list,form</field>

            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    <!-- Add Text Here -->
                </p>
                <p>
                    <!-- More details about what a user can do with this object will be OK -->
                </p>
            </field>
        </record>

        <menuitem id="peserta_menu_act_all" name="Semua Peserta" parent="pengaturan_menu_categ" action="cdn_peserta_action_all" sequence="10" />

        <menuitem id="peserta_menu_act_laki" name="Peserta Laki-laki" parent="pengaturan_menu_categ" action="cdn_peserta_action_laki" sequence="10" />

        <menuitem id="peserta_menu_act_perempuan" name="Peserta Perempuan" parent="pengaturan_menu_categ" action="cdn_peserta_action_perempuan" sequence="10" />
    </data>
</odoo>